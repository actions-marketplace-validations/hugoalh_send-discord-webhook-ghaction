# \[GitHub Action\] Send To Discord

<details>
  <summary><a href="https://github.com/hugoalh/GitHubAction.SendToDiscord"><code>hugoalh/GitHubAction.SendToDiscord</code></a></summary>
  <img align="center" alt="GitHub Language Count" src="https://img.shields.io/github/languages/count/hugoalh/GitHubAction.SendToDiscord?logo=github&logoColor=ffffff&style=flat-square" />
  <img align="center" alt="GitHub Top Langauge" src="https://img.shields.io/github/languages/top/hugoalh/GitHubAction.SendToDiscord?logo=github&logoColor=ffffff&style=flat-square" />
  <img align="center" alt="GitHub Repo Size" src="https://img.shields.io/github/repo-size/hugoalh/GitHubAction.SendToDiscord?logo=github&logoColor=ffffff&style=flat-square" />
  <img align="center" alt="GitHub Code Size" src="https://img.shields.io/github/languages/code-size/hugoalh/GitHubAction.SendToDiscord?logo=github&logoColor=ffffff&style=flat-square" />
  <img align="center" alt="GitHub Watcher" src="https://img.shields.io/github/watchers/hugoalh/GitHubAction.SendToDiscord?logo=github&logoColor=ffffff&style=flat-square" />
  <img align="center" alt="GitHub Star" src="https://img.shields.io/github/stars/hugoalh/GitHubAction.SendToDiscord?logo=github&logoColor=ffffff&style=flat-square" />
  <img align="center" alt="GitHub Fork" src="https://img.shields.io/github/forks/hugoalh/GitHubAction.SendToDiscord?logo=github&logoColor=ffffff&style=flat-square" />
</details>

A GitHub action to send message to Discord via webhook.

<table>
  <tr>
    <td><a href="./LICENSE.md"><b>License</b></a></td>
    <td>MIT</td>
  </tr>
  <tr>
    <td><a href="https://github.com/hugoalh/GitHubAction.SendToDiscord/releases"><b>Release</b></a> <img align="center" src="https://img.shields.io/github/downloads/hugoalh/GitHubAction.SendToDiscord/total?label=%20&style=flat-square" /></td>
    <td>
      <b>Latest:</b> <img align="center" src="https://img.shields.io/github/release/hugoalh/GitHubAction.SendToDiscord?sort=semver&label=%20&style=flat-square" /> (<img align="center" src="https://img.shields.io/github/release-date/hugoalh/GitHubAction.SendToDiscord?label=%20&style=flat-square" />)<br />
      <b>Pre:</b> <img align="center" src="https://img.shields.io/github/release/hugoalh/GitHubAction.SendToDiscord?include_prereleases&sort=semver&label=%20&style=flat-square" /> (<img align="center" src="https://img.shields.io/github/release-date-pre/hugoalh/GitHubAction.SendToDiscord?label=%20&style=flat-square" />)
    </td>
  </tr>
  <tr>
    <td><a href="https://github.com/hugoalh/GitHubAction.SendToDiscord/graphs/contributors"><b>Contributor</b></a> <img align="center" src="https://img.shields.io/github/contributors/hugoalh/GitHubAction.SendToDiscord?label=%20&style=flat-square" /></td>
    <td><ul>
        <li><a href="https://github.com/hugoalh">hugoalh</a></li>
        <li><a href="https://github.com/hugoalh-studio">hugoalh Studio</a></li>
    </ul></td>
  </tr>
  <tr>
    <td><a href="https://github.com/hugoalh/GitHubAction.SendToDiscord/issues?q=is%3Aissue"><b>Issue</b></a></td>
    <td><img align="center" src="https://img.shields.io/github/issues-raw/hugoalh/GitHubAction.SendToDiscord?label=%20&style=flat-square" /> : <img align="center" src="https://img.shields.io/github/issues-closed-raw/hugoalh/GitHubAction.SendToDiscord?label=%20&style=flat-square" /></td>
  </tr>
  <tr>
    <td><a href="https://github.com/hugoalh/GitHubAction.SendToDiscord/pulls?q=is%3Apr"><b>Pull Request</b></a></td>
    <td><img align="center" src="https://img.shields.io/github/issues-pr-raw/hugoalh/GitHubAction.SendToDiscord?label=%20&style=flat-square" /> : <img align="center" src="https://img.shields.io/github/issues-pr-closed-raw/hugoalh/GitHubAction.SendToDiscord?label=%20&style=flat-square" /></td>
  </tr>
  <tr>
    <td><b>Code Quality</b></td>
    <td>
      <a href="https://www.codefactor.io/repository/github/hugoalh/githubaction.sendtodiscord"><img align="center" alt="CodeFactor Grade" src="https://img.shields.io/codefactor/grade/github/hugoalh/GitHubAction.SendToDiscord?logo=codefactor&logoColor=ffffff&style=flat-square" /></a>
      <a href="https://lgtm.com/projects/g/hugoalh/GitHubAction.SendToDiscord/alerts"><img align="center" alt="LGTM Alert" src="https://img.shields.io/lgtm/alerts/g/hugoalh/GitHubAction.SendToDiscord?label=%20&logo=lgtm&logoColor=ffffff&style=flat-square" /></a>
      <a href="https://lgtm.com/projects/g/hugoalh/GitHubAction.SendToDiscord/context:javascript"><img align="center" alt="LGTM Grade" src="https://img.shields.io/lgtm/grade/javascript/g/hugoalh/GitHubAction.SendToDiscord?logo=lgtm&logoColor=ffffff&style=flat-square" /></a>
    </td>
  </tr>
</table>

## 📜 Description

### 🌟 Feature

- Simple setup.
- Support variables to create dynamic/rich content.

## 🛠 Configuration

### 🏗 Environment

#### Operating System

Any

#### Software

- NodeJS (>= v12.13)
- NPM (>= v6.12)

### 📥 Input

<table>
  <tr>
    <td>
      <b>Argument</b><br />
      <blockquote>
        <table>
          <tr>
            <td align="center"><b>Legend</b></td>
            <td><b>Description</b></td>
          </tr>
          <tr>
            <td align="center">[C]</td>
            <td>Configuration (>= v3)</td>
          </tr>
          <tr>
            <td align="center">[W]</td>
            <td>Workflow</td>
          </tr>
        </table>
      </blockquote>
    </td>
    <td>
      <b>Type</b><br />
      <blockquote>
        <table>
          <tr>
            <td align="center"><b>Legend</b></td>
            <td><b>Description</b></td>
          </tr>
          <tr>
            <td align="center">✔</td>
            <td>Require</td>
          </tr>
          <tr>
            <td align="center">[V]</td>
            <td>Support variable</td>
          </tr>
        </table>
      </blockquote>
    </td>
    <td><b>Description</b></td>
  </tr>
  <tr>
    <td>
      (>= v3)<br />
      [W] <code>configuration</code>
    </td>
    <td><code>string = "false" || object.json</code></td>
    <td>Select to use workflow argument or configuration argument.
      <ul>
        <li><b>Enable Externally:</b> A relative JSON, JSONC, YAML, or YML file path (end with <code>.json</code>, <code>.jsonc</code>, <code>.yaml</code>, or <code>.yml</code>) which in the same repository, file size must smaller than 1 MB (restricted by GitHub). Workflow argument will ignore when configuration argument is available.</li>
        <li><b>Enable Locally:</b> A stringify JSON paste in here. Workflow argument will ignore when configuration argument is available.</li>
        <li><b>Disable:</b> Use workflow argument.</li>
      </ul>
    </td>
  </tr>
  <tr>
    <td>
      (>= v3)<br />
      [W] <code>github_token</code>
    </td>
    <td><code>string.secret = "${{github.token}}"</code></td>
    <td>GitHub personal access token, only use when need to fetch the configuration file specify in the <code>configuration</code>.</td>
  </tr>
  <tr>
    <td>
      [W] <code>webhook_id</code>
    </td>
    <td><code>string.secret</code><br />✔</td>
    <td>Discord webhook ID. If the webhook url is <code>https://discord.com/api/webhooks/70971114/ueyzeWxB_8bb1zMhL</code>, then the webhook ID will be <code>70971114</code>.</td>
  </tr>
  <tr>
    <td>
      [W] <code>webhook_token</code>
    </td>
    <td><code>string.secret</code><br />✔</td>
    <td>Discord webhook token. If the webhook url is <code>https://discord.com/api/webhooks/70971114/ueyzeWxB_8bb1zMhL</code>, then the webhook token will be <code>ueyzeWxB_8bb1zMhL</code>.</td>
  </tr>
  <tr>
    <td>
      [W] <code>variable_join</code>
    </td>
    <td><code>string = "_"</code></td>
    <td>Variable join if the variable list has depth.</td>
    </tr>
  <tr>
    <td>
      [W] <code>variable_list_external</code>
    </td>
    <td><code>object.json</code></td>
    <td>External variable list that will use in the data.</td>
    </tr>
  <tr>
    <td>
      [W] <code>variable_prefix</code>
    </td>
    <td><code>string = "%"</code></td>
    <td>Variable prefix.</td>
    </tr>
  <tr>
    <td>
      [W] <code>variable_suffix</code>
    </td>
    <td><code>string = "%"</code></td>
    <td>Variable suffix.</td>
    </tr>
  <tr>
    <td>
      [C] <code>content</code><br />
      [W] <code>message_text</code>
    </td>
    <td><code>string</code><br />[V]</td>
    <td>Text. Automatically crop when more than 2000 characters.</td>
  </tr>
  <tr>
    <td>
      [C] <code>username</code><br />
      [W] <code>webhook_name</code>
    </td>
    <td><code>string</code><br />[V]</td>
    <td>Webhook display name (i.e.: the sender's name), this can override the default username of the webhook. Automatically ignore when not between 2 and 32 characters.</td>
  </tr>
  <tr>
    <td>
      [C] <code>avatar_url</code><br />
      [W] <code>webhook_avatarurl</code>
    </td>
    <td><code>string</code><br />[V]</td>
    <td>Webhook avatar url (i.e.: the sender's avatar), this can override the default avatar of the webhook. The image url must be in format of JPEG/JPG, or PNG. GIF is not supported due to restricted by Discord.</td>
  </tr>
  <tr>
    <td>
      [C] <code>tts</code><br />
      [W] <code>message_usetexttospeech</code>
    </td>
    <td><code>boolean = false</code></td>
    <td>Use text to speech for this message.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt</code><br />
      [W] <code>message_embed</code>
    </td>
    <td></td>
    <td>Embed(s) for this message. For configuration argument, number start at <code>0</code>, maximum 10 embeds per message; For workflow argument, maximum 1 embed per message.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.title</code><br />
      [W] <code>message_embed_title</code>
    </td>
    <td><code>string</code><br />✔ When have <code>embeds.&ltArray&gt.url</code><br />[V]</td>
    <td>Embed title. Automatically crop when more than 256 characters.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.description</code><br />
      [W] <code>message_embed_description</code>
    </td>
    <td><code>string</code><br />[V]</td>
    <td>Embed description. Automatically crop when more than 2048 characters.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.url</code><br />
      [W] <code>message_embed_titleurl</code>
    </td>
    <td><code>string</code><br />[V]</td>
    <td>Embed title url.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.color</code><br />
      [W] <code>message_embed_colour</code>
    </td>
    <td><code>string = "invisible"</code><br />✔ When have embed(s)</td>
    <td>
      Left border's colour of this embed.
      <ul>
        <li><code>"black"</code></li>
        <li><code>"discordblack"</code></li>
        <li><code>"discordblurple"</code></li>
        <li><code>"discorddark"</code></li>
        <li><code>"discordgreyple"</code></li>
        <li><code>"invisible"</code></li>
        <li><code>"random"</code></li>
        <li><code>"white"</code></li>
        <li>RGB split with comma (<code>,</code>) (example: <code>256,128,64</code>)
      </ul>
    </td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.footer.text</code><br />
      [W] <code>message_embed_footertext</code>
    </td>
    <td><code>string</code><br />[V]</td>
    <td>Embed footer text. Automatically crop when more than 2048 characters.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.footer.icon_url</code><br />
      [W] <code>message_embed_footericonurl</code>
    </td>
    <td><code>string</code><br />[V]</td>
    <td>Embed footer icon url. The image url must be in format of JPEG/JPG, or PNG. GIF is not supported due to restricted by Discord.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.image.url</code><br />
      [W] <code>message_embed_imageurl</code>
    </td>
    <td><code>string</code><br />[V]</td>
    <td>Embed image url. The image url must be in format of JPEG/JPG, PNG, or GIF.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.thumbnail.url</code><br />
      [W] <code>message_embed_thumbnailurl</code>
    </td>
    <td><code>string</code><br />[V]</td>
    <td>Embed thumbnail url. The image url must be in format of JPEG/JPG, PNG, or GIF.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.video.url</code><br />
      [W] <code>message_embed_videourl</code>
    </td>
    <td><code>string</code><br />[V]</td>
    <td>Embed video url. Support YouTube only!</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.author.name</code><br />
      [W] <code>message_embed_authorname</code>
    </td>
    <td><code>string</code><br />✔ When have <code>embeds.&ltArray&gt.author.url</code><br />[V]</td>
    <td>Embed author name. Automatically crop when more than 256 characters.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.author.url</code><br />
      [W] <code>message_embed_authorurl</code>
    </td>
    <td><code>string</code><br />[V]</td>
    <td>Embed author url.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.author.icon_url</code><br />
      [W] <code>message_embed_authoravatarurl</code>
    </td>
    <td><code>string</code><br />[V]</td>
    <td>Embed author avatar url. The image url must be in format of JPEG/JPG, or PNG. GIF is not supported due to restricted by Discord.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.fields.&ltArray&gt</code><br />
      [W] <code>message_embed_field_&ltNumber&gt</code>
    </td>
    <td></td>
    <td>Field(s) for this embed. Number start at <code>0</code>, maximum 25 fields per embed.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.fields.&ltArray&gt.name</code><br />
      [W] <code>message_embed_field_&ltNumber&gt_key</code>
    </td>
    <td><code>string</code><br />✔ When have <code>embeds.&ltArray&gt.fields.&ltArray&gt.value</code><br />[V]</td>
    <td>Key for this embed field. Automatically crop when more than 256 characters.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.fields.&ltArray&gt.value</code><br />
      [W] <code>message_embed_field_&ltNumber&gt_value</code>
    </td>
    <td><code>string</code><br />✔ When have <code>embeds.&ltArray&gt.fields.&ltArray&gt.key</code><br />[V]</td>
    <td>Value for this embed field. Automatically crop when more than 1024 characters.</td>
  </tr>
  <tr>
    <td>
      [C] <code>embeds.&ltArray&gt.fields.&ltArray&gt.inline</code><br />
      [W] <code>message_embed_field_&ltNumber&gt_isinline</code>
    </td>
    <td><code>boolean = false</code></td>
    <td>Use inline for this embed field.</td>
  </tr>
</table>

To use GitHub Action context variable list, use placeholder `"${{github.event.<namespace>}}"` in the workflow file (parse by GitHub Action), or use placeholder `"<variable_prefix>payload<variable_join><namespace><variable_suffix>"` in the workflow file which marked support variable (parse by this action).

To use external variable list, use placeholder `"<variable_prefix>external<variable_join><namespace><variable_suffix>"` in the workflow file which marked support variable (parse by this action).

### 📤 Output

*(N/A)*

### Example

#### Workflow Argument (>= v2)

```yml
jobs:
  send-to-discord:
    name: "Send To Discord"
    runs-on: "ubuntu-latest"
    steps:
      - id: "send-to-discord-main"
        uses: "hugoalh/GitHubAction.SendToDiscord@v2.0.0"
        with:
          webhook_id: "${{secrets.DISCORD_WEBHOOK_ID}}"
          webhook_token: "${{secrets.DISCORD_WEBHOOK_TOKEN}}"
          variable_join: "."
          # variable_list_external:
          variable_prefix: "%"
          variable_suffix: "%"
          message_text: "Hello, world!"
          # webhook_name:
          # webhook_avatarurl:
          message_usetexttospeech: "false"
          # message_embed_title:
          # message_embed_description:
          # message_embed_titleurl:
          # message_embed_colour:
          # message_embed_footertext:
          # message_embed_footericonurl:
          # message_embed_imageurl:
          # message_embed_thumbnailurl:
          # message_embed_videourl:
          # message_embed_authorname:
          # message_embed_authorurl:
          # message_embed_authoravatarurl:
          # message_embed_field_0_key:
          # message_embed_field_0_value:
          # message_embed_field_0_isinline:
          # message_embed_field_1_key:
          # message_embed_field_1_value:
          # message_embed_field_1_isinline:
          # message_embed_field_2_key:
          # message_embed_field_2_value:
          # message_embed_field_2_isinline:
          # message_embed_field_3_key:
          # message_embed_field_3_value:
          # message_embed_field_3_isinline:
          # message_embed_field_4_key:
          # message_embed_field_4_value:
          # message_embed_field_4_isinline:
          # message_embed_field_5_key:
          # message_embed_field_5_value:
          # message_embed_field_5_isinline:
          # message_embed_field_6_key:
          # message_embed_field_6_value:
          # message_embed_field_6_isinline:
          # message_embed_field_7_key:
          # message_embed_field_7_value:
          # message_embed_field_7_isinline:
          # message_embed_field_8_key:
          # message_embed_field_8_value:
          # message_embed_field_8_isinline:
          # message_embed_field_9_key:
          # message_embed_field_9_value:
          # message_embed_field_9_isinline:
          # message_embed_field_10_key:
          # message_embed_field_10_value:
          # message_embed_field_10_isinline:
          # message_embed_field_11_key:
          # message_embed_field_11_value:
          # message_embed_field_11_isinline:
          # message_embed_field_12_key:
          # message_embed_field_12_value:
          # message_embed_field_12_isinline:
          # message_embed_field_13_key:
          # message_embed_field_13_value:
          # message_embed_field_13_isinline:
          # message_embed_field_14_key:
          # message_embed_field_14_value:
          # message_embed_field_14_isinline:
          # message_embed_field_15_key:
          # message_embed_field_15_value:
          # message_embed_field_15_isinline:
          # message_embed_field_16_key:
          # message_embed_field_16_value:
          # message_embed_field_16_isinline:
          # message_embed_field_17_key:
          # message_embed_field_17_value:
          # message_embed_field_17_isinline:
          # message_embed_field_18_key:
          # message_embed_field_18_value:
          # message_embed_field_18_isinline:
          # message_embed_field_19_key:
          # message_embed_field_19_value:
          # message_embed_field_19_isinline:
          # message_embed_field_20_key:
          # message_embed_field_20_value:
          # message_embed_field_20_isinline:
          # message_embed_field_21_key:
          # message_embed_field_21_value:
          # message_embed_field_21_isinline:
          # message_embed_field_22_key:
          # message_embed_field_22_value:
          # message_embed_field_22_isinline:
          # message_embed_field_23_key:
          # message_embed_field_23_value:
          # message_embed_field_23_isinline:
          # message_embed_field_24_key:
          # message_embed_field_24_value:
          # message_embed_field_24_isinline:
```

#### Configuration Argument (>= v3)

```yml
# Workflow file
jobs:
  send-to-discord:
    name: "Send To Discord"
    runs-on: "ubuntu-latest"
    steps:
      - id: "send-to-discord-main"
        uses: "hugoalh/GitHubAction.SendToDiscord@v3.0.0"
        with:
          configuration: ".github/workflows_configuration/send-to-discord.json"
          webhook_id: "${{secrets.DISCORD_WEBHOOK_ID}}"
          webhook_token: "${{secrets.DISCORD_WEBHOOK_TOKEN}}"
          variable_join: "."
          # variable_list_external:
          variable_prefix: "%"
          variable_suffix: "%"
```

```jsonc
// Configutation file (.github/workflows_configuration/send-to-discord.json)
{
  "content": "Hello, world!",
  "username": "A Webhook Guy",
  "avatar_url": "https://imgur.com/webhook-avatar.png",
  "tts": false,
  "embeds": [
    {
      "title": "1st Embed",
      "description": "Yes!",
      "url": "https://github.com/hugoalh/GitHubAction.SendToDiscord",
      "color": 0,
      "footer": {
        "text": "1st Embed Footer",
        "icon_url": "https://imgur.com/first-footer-icon.png"
      },
      "image": {
        "url": "https://imgur.com/first-big-image.png"
      },
      "thumbnail": {
        "url": "https://imgur.com/first-small-image.png"
      },
      "video": {
        "url": "https://youtube.com/first-video"
      },
      "author": {
        "name": "A Embed Guy",
        "url": "https://handsome.io",
        "icon_url": "https://imgur.com/handsome-avatar.png"
      },
      "fields": [
        {
          "name": "1st Field",
          "value": "Foo",
          "inline": true
        },
        {
          "name": "2nd Field",
          "value": "Bar",
          "inline": true
        },
        ...
      ]
    },
    {
      "title": "2nd Embed",
      "description": "Yee!",
      "url": "https://github.com/hugoalh/GitHubAction.SendToDiscord",
      "color": 0,
      "footer": {
        "text": "2nd Embed Footer",
        "icon_url": "https://imgur.com/second-footer-icon.png"
      },
      "image": {
        "url": "https://imgur.com/second-big-image.png"
      },
      "thumbnail": {
        "url": "https://imgur.com/second-small-image.png"
      },
      "video": {
        "url": "https://youtube.com/second-video"
      },
      "author": {
        "name": "Another Embed Guy",
        "url": "https://goodlook.io",
        "icon_url": "https://imgur.com/good-look-avatar.png"
      },
      "fields": [
        {
          "name": "1st Field",
          "value": "Lol",
          "inline": false
        },
        {
          "name": "2nd Field",
          "value": "Arm",
          "inline": false
        },
        ...
      ]
    },
    ...
  ]
}
```

### 📚 Guide

- [Discord Developer Portal: Webhook - Execute](https://discord.com/developers/docs/resources/webhook#execute-webhook)
- [Discord: Intro to Webhooks](https://support.discord.com/hc/en-us/articles/228383668-Intro-to-Webhooks)
- [GitHub Actions: Enabling debug logging](https://docs.github.com/en/free-pro-team@latest/actions/managing-workflow-runs/enabling-debug-logging)
- [GitHub Actions: Encrypted secrets](https://docs.github.com/en/free-pro-team@latest/actions/reference/encrypted-secrets)
- [GitHub: Webhook events and payloads](https://docs.github.com/en/free-pro-team@latest/developers/webhooks-and-events/webhook-events-and-payloads)
